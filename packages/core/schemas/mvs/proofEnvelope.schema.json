{
  "$id": "urn:zkpip:mvs:schemas:proofEnvelope.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "ZKPIP MVS Proof Envelope",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "envelopeId",
    "schemaVersion",
    "proofSystem",
    "curve",
    "prover",
    "program",
    "artifacts"
  ],
  "anyOf": [
    {
      "type": "object",
      "properties": {
        "result": {}
      },
      "required": ["result"]
    },
    {
      "type": "object",
      "properties": {
        "artifacts": {
          "type": "object",
          "properties": {
            "vkey": {},
            "proof": {},
            "publicSignals": {}
          },
          "required": ["vkey", "proof", "publicSignals"]
        }
      }
    }
  ],
  "properties": {
    "envelopeId": {
      "type": "string",
      "pattern": "^urn:uuid:[0-9a-fA-F-]{36}$"
    },
    "schemaVersion": {
      "type": "string",
      "pattern": "^0\\.1\\.0$"
    },
    "proofSystem": {
      "type": "string",
      "enum": [
        "groth16"
      ]
    },
    "curve": {
      "type": "string",
      "enum": [
        "bn128",
        "bn254"
      ]
    },
    "prover": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "name"
          ],
          "properties": {
            "name": {
              "type": "string"
            },
            "version": {
              "type": "string"
            }
          }
        }
      ]
    },
    "program": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "language"
      ],
      "properties": {
        "language": {
          "type": "string",
          "enum": [
            "circom"
          ]
        },
        "entry": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      }
    },
    "artifacts": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "vkey": {
          "$ref": "#/$defs/ArtifactRef"
        },
        "proof": {
          "$ref": "#/$defs/ArtifactRef"
        },
        "publicSignals": {
          "$ref": "#/$defs/ArtifactRef"
        },
        "wasm": {
          "$ref": "#/$defs/ArtifactRef"
        },
        "zkey": {
          "$ref": "#/$defs/ArtifactRef"
        }
      }
    },
    "result": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "proof",
        "publicSignals"
      ],
      "properties": {
        "proof": {
          "type": "object"
        },
        "publicSignals": {
          "type": "array",
          "minItems": 1,
          "items": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "number"
              }
            ]
          }
        }
      }
    }
  },
  "$defs": {
    "ArtifactRef": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "path"
      ],
      "properties": {
        "path": {
          "type": "string"
        },
        "uri": {
          "type": "string",
          "format": "uri"
        },
        "size": {
          "type": "integer",
          "minimum": 0
        },
        "mediaType": {
          "type": "string"
        },
        "hash": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "alg",
            "value"
          ],
          "properties": {
            "alg": {
              "type": "string",
              "enum": [
                "sha256"
              ]
            },
            "value": {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{64}$"
            }
          }
        }
      }
    }
  }
}
